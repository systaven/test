import{u as se,o as c,c as b,a as Re,w as a,b as t,V as De,d,t as s,e as x,f as V,g as Ue,h as e,i as $e,j as Ae,s as Be,r as p,k as M,l as r,m as He,F as pe,n as Pe,p as g,q as Ne,v as We,x as E,y as Ve,z as te,A as Se,B as oe,C as le,D as he,E as Fe,G as L,H as ge,I as Ce,J as ie,K as ne,L as Xe,M as Ye,N as fe,O as qe,P as ve,Q as J,R as be,S as je,T as Q,U as ye,W as _e,X as we,Y as Ge,Z as Ke,_ as A,$ as xe,a0 as Oe,a1 as Je,a2 as Qe,a3 as Ze,a4 as ea}from"./index-427e6df5.js";import{u as B}from"./customizer-fda73318.js";import{L as aa,m as ke}from"./md5-cc9d8ced.js";import{L as ta}from"./LanguageSwitcher-d6ec75cb.js";import{u as oa}from"./common-74ca9dd8.js";import{M as la}from"./index-47e3efb7.js";import{M as ia}from"./MigrationDialog-12e3e2ea.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ConsoleDisplayer-b4e5ebdb.js";import"./WaitingForRestart-c0cfd70f.js";const na=[{title:"core.navigation.dashboard",icon:"mdi-view-dashboard",to:"/dashboard/default"},{title:"core.navigation.platforms",icon:"mdi-message-processing",to:"/platforms"},{title:"core.navigation.providers",icon:"mdi-creation",to:"/providers"},{title:"core.navigation.toolUse",icon:"mdi-function-variant",to:"/tool-use"},{title:"core.navigation.persona",icon:"mdi-heart",to:"/persona"},{title:"core.navigation.extension",icon:"mdi-puzzle",to:"/extension"},{title:"core.navigation.knowledgeBase",icon:"mdi-text-box-search",to:"/alkaid/knowledge-base"},{title:"core.navigation.config",icon:"mdi-cog",to:"/config"},{title:"core.navigation.chat",icon:"mdi-chat",to:"/chat"},{title:"core.navigation.conversation",icon:"mdi-database",to:"/conversation"},{title:"core.navigation.sessionManagement",icon:"mdi-account-group",to:"/session-management"},{title:"core.navigation.console",icon:"mdi-console",to:"/console"}],sa={__name:"NavItem",props:{item:Object,level:Number},setup(h){const{t:S}=se();return(f,l)=>(c(),b(Ae,{to:h.item.type==="external"?"":h.item.to,href:h.item.type==="external"?h.item.to:"",rounded:"",class:"mb-1",color:"secondary",disabled:h.item.disabled,target:h.item.type==="external"?"_blank":""},Re({prepend:a(()=>[h.item.icon?(c(),b(x,{key:0,size:h.item.iconSize,class:"hide-menu",icon:h.item.icon},null,8,["size","icon"])):V("",!0)]),default:a(()=>[t(Ue,{style:{"font-size":"14px"}},{default:a(()=>[d(s(e(S)(h.item.title)),1)]),_:1}),h.item.subCaption?(c(),b($e,{key:0,class:"text-caption mt-n1 hide-menu"},{default:a(()=>[d(s(h.item.subCaption),1)]),_:1})):V("",!0)]),_:2},[h.item.chip?{name:"append",fn:a(()=>[t(De,{color:h.item.chipColor,class:"sidebarchip hide-menu",size:h.item.chipIcon?"small":"default",variant:h.item.chipVariant,"prepend-icon":h.item.chipIcon},{default:a(()=>[d(s(h.item.chip),1)]),_:1},8,["color","size","variant","prepend-icon"])]),key:"0"}:void 0]),1032,["to","href","disabled","target"]))}},ra={class:"sidebar-container"},da={key:0,class:"sidebar-footer"},ua={style:{display:"flex","align-items":"center"}},ca={style:{"margin-left":"8px"}},ma={style:{display:"flex",gap:"8px"}},pa=r("iframe",{src:"https://astrbot.app",style:{width:"100%",height:"calc(100% - 56px)",border:"none","border-bottom-left-radius":"12px","border-bottom-right-radius":"12px"}},null,-1),ha={__name:"VerticalSidebar",setup(h){const{t:S}=se(),f=B(),l=Be(na),v=p(!1),C=p({position:"fixed",bottom:"16px",right:"16px",width:"490px",height:"640px",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"10000000",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"});window.innerWidth<768&&(C.value={position:"fixed",top:"10%",left:"0%",width:"100%",height:"50%",minWidth:"300px",minHeight:"200px",background:"white",resize:"both",overflow:"auto",zIndex:"1002",borderRadius:"12px",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)"},f.Sidebar_drawer=!1);const T={width:"100%",padding:"8px",background:"#f0f0f0",borderBottom:"1px solid #ccc",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move"};function G(){v.value=!v.value}function k(u){if(typeof window<"u"){let m=u||"https://astrbot.app";window.open(m,"_blank")}}let D=0,z=0,y=!1;function H(u,m,w){return Math.min(Math.max(u,m),w)}function X(u,m){y=!0;const R=document.getElementById("draggable-iframe").getBoundingClientRect();D=u-R.left,z=m-R.top,document.body.style.userSelect="none",document.addEventListener("mousemove",U),document.addEventListener("mouseup",q),document.addEventListener("touchmove",P,{passive:!1}),document.addEventListener("touchend",j)}function Y(u){X(u.clientX,u.clientY)}function U(u){y&&N(u.clientX,u.clientY)}function q(){W()}function $(u){if(u.touches.length===1){const m=u.touches[0];X(m.clientX,m.clientY)}}function P(u){if(y&&u.touches.length===1){u.preventDefault();const m=u.touches[0];N(m.clientX,m.clientY)}}function j(){W()}function N(u,m){const w=document.getElementById("draggable-iframe"),R=H(u-D,0,window.innerWidth-w.offsetWidth),Z=H(m-z,0,window.innerHeight-w.offsetHeight);C.value.left=R+"px",C.value.top=Z+"px"}function W(){y=!1,document.body.style.userSelect="",document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",q),document.removeEventListener("touchmove",P),document.removeEventListener("touchend",j)}return(u,m)=>(c(),M(pe,null,[t(Ne,{left:"",modelValue:e(f).Sidebar_drawer,"onUpdate:modelValue":m[1]||(m[1]=w=>e(f).Sidebar_drawer=w),elevation:"0","rail-width":"80",app:"",class:"leftSidebar",width:"220",rail:e(f).mini_sidebar},{default:a(()=>[r("div",ra,[t(He,{class:"pa-4 listitem flex-grow-1"},{default:a(()=>[(c(!0),M(pe,null,Pe(l.value,(w,R)=>(c(),b(sa,{key:R,item:w,class:"leftPadding"},null,8,["item"]))),128))]),_:1}),e(f).mini_sidebar?V("",!0):(c(),M("div",da,[t(g,{style:{"margin-bottom":"8px"},size:"small",variant:"tonal",color:"primary",to:"/settings"},{default:a(()=>[d(" 🔧 "+s(e(S)("core.navigation.settings")),1)]),_:1}),t(g,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:G},{default:a(()=>[d(s(e(S)("core.navigation.documentation")),1)]),_:1}),t(g,{style:{"margin-bottom":"8px"},size:"small",variant:"plain",onClick:m[0]||(m[0]=w=>k("https://github.com/AstrBotDevs/AstrBot"))},{default:a(()=>[d(s(e(S)("core.navigation.github")),1)]),_:1})]))])]),_:1},8,["modelValue","rail"]),v.value?(c(),M("div",{key:0,id:"draggable-iframe",style:We(C.value)},[r("div",{style:T,onMousedown:Y,onTouchstart:$},[r("div",ua,[t(x,{icon:"mdi-cursor-move"}),r("span",ca,s(e(S)("core.navigation.drag")),1)]),r("div",ma,[t(g,{icon:"",onClick:m[2]||(m[2]=E(w=>k("https://astrbot.app"),["stop"])),onMousedown:m[3]||(m[3]=E(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:a(()=>[t(x,{icon:"mdi-open-in-new"})]),_:1}),t(g,{icon:"",onClick:E(G,["stop"]),onMousedown:m[4]||(m[4]=E(()=>{},["stop"])),style:{"border-radius":"8px",border:"1px solid #ccc"}},{default:a(()=>[t(x,{icon:"mdi-close"})]),_:1},8,["onClick"])])],32),pa],4)):V("",!0)],64))}},ga=r("span",{class:"logo-text"},[d("Astr"),r("span",{class:"logo-text-light"},"Bot")],-1),fa={class:"version-text hidden-xs"},va={class:"mr-4 hidden-xs"},ba={key:0},ya={key:1},_a={class:"text-h5"},wa={style:{display:"inline-block"}},xa={style:{"margin-left":"4px"}},ka=["innerHTML"],Da={class:"mb-4 mt-4"},Va={class:"mb-4"},Sa={href:"https://containrrr.dev/watchtower/usage-overview/"},Ca={class:"text-body-2"},Ta=r("br",null,null,-1),Ia={href:"https://github.com/Soulter/AstrBot/issues",target:"_blank",class:"text-decoration-none"},La={class:"d-flex align-center"},za={style:{"margin-top":"16px"}},Ma={class:"mb-4"},Ea={class:"mb-4"},Ra=r("br",null,null,-1),Ua={href:"https://github.com/Soulter/AstrBot/commits/master"},$a={style:{"margin-top":"16px"}},Aa={class:"mb-4"},Ba={class:"mb-4"},Ha=r("br",null,null,-1),Pa={class:"mb-4"},Na={key:0},Wa={key:1},Fa={class:"d-flex flex-column align-center mb-6"},Xa={class:"text-caption text-medium-emphasis mt-2"},Ya=Ve({__name:"VerticalHeader",setup(h){const S=new la({html:!0,breaks:!0,linkify:!0,typographer:!1}),f=B(),{t:l}=se();let v=p(!1),C=p(!1),T=p(!1);const G=localStorage.getItem("user");let k=p(""),D=p(""),z=p("");p("");let y=p(""),H=p(""),X=p(!1),Y=p(""),U=p(!1),q=p(""),$=p(""),P=p([]),j=p([]),N=p(!1),W=p(!1),u=p(0);const m=te(()=>[{title:l("core.header.updateDialog.table.tag"),key:"tag_name"},{title:l("core.header.updateDialog.table.publishDate"),key:"published_at"},{title:l("core.header.updateDialog.table.content"),key:"body"},{title:l("core.header.updateDialog.table.sourceUrl"),key:"zipball_url"},{title:l("core.header.updateDialog.table.actions"),key:"switch"}]),w=p(!0),R=te(()=>[i=>!!i||l("core.header.accountDialog.validation.passwordRequired"),i=>i.length>=8||l("core.header.accountDialog.validation.passwordMinLength")]),Z=te(()=>[i=>!i||i.length>=3||l("core.header.accountDialog.validation.usernameMinLength")]),K=p(!1),O=p(!1),_=p({loading:!1,success:!1,error:!1,message:""}),re=i=>{const o=["alpha","beta","rc","pre","preview","dev"],n=i.toLowerCase();return o.some(I=>n.includes(I))};function de(){_.value.loading=!0,_.value.error=!1,_.value.success=!1,k.value!=""&&(k.value=ke.md5(k.value)),D.value!=""&&(D.value=ke.md5(D.value)),A.post("/api/auth/account/edit",{password:k.value,new_password:D.value,new_username:z.value?z.value:G}).then(i=>{if(i.data.status=="error"){_.value.error=!0,_.value.message=i.data.message,k.value="",D.value="";return}_.value.success=!0,_.value.message=i.data.message,setTimeout(()=>{v.value=!v.value,xe().logout()},2e3)}).catch(i=>{console.log(i),_.value.error=!0,_.value.message=typeof i=="string"?i:l("core.header.accountDialog.messages.updateFailed"),k.value="",D.value=""}).finally(()=>{_.value.loading=!1})}function Te(){A.get("/api/stat/version").then(i=>{var n,I;Y.value="v"+i.data.data.version,q.value=(n=i.data.data)==null?void 0:n.dashboard_version,((I=i.data.data)==null?void 0:I.change_pwd_hint)?(v.value=!0,C.value=!0,localStorage.setItem("change_pwd_hint","true")):localStorage.removeItem("change_pwd_hint")}).catch(i=>{console.log(i)})}function ue(){y.value=l("core.header.updateDialog.status.checking"),A.get("/api/update/check").then(i=>{X.value=i.data.data.has_new_version,i.data.data.has_new_version?(H.value=i.data.message,y.value=l("core.header.version.hasNewVersion")):y.value=i.data.message,U.value=i.data.data.dashboard_has_new_version}).catch(i=>{if(i.response&&i.response.status==401){console.log("401"),xe().logout();return}console.log(i),y.value=i})}function Ie(){A.get("/api/update/releases").then(i=>{P.value=i.data.data.map(o=>(o.published_at=new Date(o.published_at).toLocaleString(),o))}).catch(i=>{console.log(i)})}function Le(){let i=localStorage.getItem("selectedGitHubProxy")||"";const o="https://api.github.com/repos/Soulter/AstrBot/commits";let n=o;i!==""&&(i=i.endsWith("/")?i:i+"/",n=i+o);function I(Ee,me){fetch(Ee,{headers:{Host:"api.github.com",Referer:"https://api.github.com"}}).then(F=>F.json()).then(F=>{j.value=Array.isArray(F)?F.map(ae=>({sha:ae.sha,date:new Date(ae.commit.author.date).toLocaleString(),message:ae.commit.message})):[]}).catch(F=>{me?me():console.log("获取开发版提交信息失败:",F)})}I(n,()=>{i!==""&&n!==o&&(console.log("使用代理请求失败，尝试直接请求"),I(o))})}function ee(i){y.value=l("core.header.updateDialog.status.switching"),W.value=!0,A.post("/api/update/do",{version:i,proxy:localStorage.getItem("selectedGitHubProxy")||""}).then(o=>{y.value=o.data.message,o.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(o=>{console.log(o),y.value=o}).finally(()=>{W.value=!1})}function ze(){N.value=!0,y.value=l("core.header.updateDialog.status.updating"),A.post("/api/update/dashboard").then(i=>{y.value=i.data.message,i.data.status=="ok"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(i=>{console.log(i),y.value=i}).finally(()=>{N.value=!1})}function Me(){f.SET_UI_THEME(f.uiTheme==="PurpleThemeDark"?"PurpleTheme":"PurpleThemeDark")}Te(),ue();const ce=oa();return ce.createEventSource(),ce.getStartTime(),(i,o)=>(c(),b(Ke,{elevation:"0",height:"55"},{default:a(()=>[e(B)().uiTheme==="PurpleTheme"?(c(),b(g,{key:0,style:{"margin-left":"22px"},class:"hidden-md-and-down text-secondary",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:o[0]||(o[0]=E(n=>e(f).SET_MINI_SIDEBAR(!e(f).mini_sidebar),["stop"])),size:"small"},{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-menu")]),_:1})]),_:1})):(c(),b(g,{key:1,style:{"margin-left":"22px",color:"var(--v-theme-primaryText)","background-color":"var(--v-theme-secondary)"},class:"hidden-md-and-down",icon:"",rounded:"sm",variant:"flat",onClick:o[1]||(o[1]=E(n=>e(f).SET_MINI_SIDEBAR(!e(f).mini_sidebar),["stop"])),size:"small"},{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-menu")]),_:1})]),_:1})),e(B)().uiTheme==="PurpleTheme"?(c(),b(g,{key:2,class:"hidden-lg-and-up ms-3",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:E(e(f).SET_SIDEBAR_DRAWER,["stop"]),size:"small"},{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-menu")]),_:1})]),_:1},8,["onClick"])):(c(),b(g,{key:3,class:"hidden-lg-and-up ms-3",icon:"",rounded:"sm",variant:"flat",onClick:E(e(f).SET_SIDEBAR_DRAWER,["stop"]),size:"small"},{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-menu")]),_:1})]),_:1},8,["onClick"])),r("div",{class:Se(["logo-container",{"mobile-logo":i.$vuetify.display.xs}]),onClick:o[2]||(o[2]=n=>i.$router.push("/about"))},[ga,r("span",fa,s(e(Y)),1)],2),t(oe),r("div",va,[e(X)?(c(),M("small",ba,s(e(l)("core.header.version.hasNewVersion")),1)):e(U)?(c(),M("small",ya,s(e(l)("core.header.version.dashboardHasNewVersion")),1)):V("",!0)]),t(ta,{variant:"header"}),t(g,{size:"small",onClick:o[3]||(o[3]=n=>{Me()}),class:"action-btn",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm",icon:""},{default:a(()=>[e(B)().uiTheme==="PurpleThemeDark"?(c(),b(x,{key:0},{default:a(()=>[d("mdi-weather-night")]),_:1})):(c(),b(x,{key:1},{default:a(()=>[d("mdi-white-balance-sunny")]),_:1}))]),_:1}),t(we,{modelValue:e(T),"onUpdate:modelValue":o[12]||(o[12]=n=>L(T)?T.value=n:T=n),width:i.$vuetify.display.smAndDown?"100%":"1200",fullscreen:i.$vuetify.display.xs},{activator:a(({props:n})=>[t(g,le({size:"small",onClick:o[4]||(o[4]=I=>{ue(),Ie(),Le()}),class:"action-btn",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm"},n,{icon:""}),{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-arrow-up-circle")]),_:1})]),_:2},1040)]),default:a(()=>[t(he,null,{default:a(()=>[t(Fe,{class:"mobile-card-title"},{default:a(()=>[r("span",_a,s(e(l)("core.header.updateDialog.title")),1),i.$vuetify.display.xs?(c(),b(g,{key:0,icon:"",onClick:o[5]||(o[5]=n=>L(T)?T.value=!1:T=!1)},{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-close")]),_:1})]),_:1})):V("",!0)]),_:1}),t(ge,null,{default:a(()=>[t(Ce,null,{default:a(()=>[ie(t(Xe,{class:"mb-4",indeterminate:"",color:"primary"},null,512),[[ne,e(W)]]),r("div",null,[r("h1",wa,s(e(Y)),1),r("small",xa,s(e(y)),1)]),e(H)?(c(),M("div",{key:0,style:{"background-color":"#646cff24",padding:"16px","border-radius":"10px","font-size":"14px","max-height":"400px","overflow-y":"auto"},innerHTML:e(S).render(e(H)),class:"markdown-content"},null,8,ka)):V("",!0),r("div",Da,[r("small",null,s(e(l)("core.header.updateDialog.tip"))+" "+s(e(l)("core.header.updateDialog.tipContinue")),1)]),t(Ye,{modelValue:e(u),"onUpdate:modelValue":o[6]||(o[6]=n=>L(u)?u.value=n:u=n)},{default:a(()=>[t(fe,{value:"0"},{default:a(()=>[d(s(e(l)("core.header.updateDialog.tabs.release")),1)]),_:1}),t(fe,{value:"1"},{default:a(()=>[d(s(e(l)("core.header.updateDialog.tabs.dev")),1)]),_:1})]),_:1},8,["modelValue"]),t(qe,{modelValue:e(u),"onUpdate:modelValue":o[7]||(o[7]=n=>L(u)?u.value=n:u=n)},{default:a(()=>[ie(t(ve,{key:"0"},{default:a(()=>[r("div",Va,[r("small",null,[d(s(e(l)("core.header.updateDialog.dockerTip"))+" ",1),r("a",Sa,s(e(l)("core.header.updateDialog.dockerTipLink")),1),d(" "+s(e(l)("core.header.updateDialog.dockerTipContinue")),1)])]),e(P).some(n=>re(n.tag_name))?(c(),b(J,{key:0,type:"warning",variant:"tonal",border:"start"},{prepend:a(()=>[t(x,null,{default:a(()=>[d("mdi-alert-circle-outline")]),_:1})]),default:a(()=>[r("div",Ca,[r("strong",null,s(e(l)("core.header.updateDialog.preReleaseWarning.title")),1),Ta,d(" "+s(e(l)("core.header.updateDialog.preReleaseWarning.description"))+" ",1),r("a",Ia,s(e(l)("core.header.updateDialog.preReleaseWarning.issueLink")),1)])]),_:1})):V("",!0),t(be,{headers:m.value,items:e(P),"item-key":"name","items-per-page":5},{"item.tag_name":a(({item:n})=>[r("div",La,[r("span",null,s(n.tag_name),1),re(n.tag_name)?(c(),b(De,{key:0,size:"x-small",color:"warning",variant:"tonal",class:"ml-2"},{default:a(()=>[d(s(e(l)("core.header.updateDialog.preRelease")),1)]),_:1})):V("",!0)])]),"item.body":a(({item:n})=>[t(je,{text:n.body},{activator:a(({props:I})=>[t(g,le(I,{rounded:"xl",variant:"tonal",color:"primary",size:"x-small"}),{default:a(()=>[d(s(e(l)("core.header.updateDialog.table.view")),1)]),_:2},1040)]),_:2},1032,["text"])]),"item.switch":a(({item:n})=>[t(g,{onClick:I=>ee(n.tag_name),rounded:"xl",variant:"plain",color:"primary"},{default:a(()=>[d(s(e(l)("core.header.updateDialog.table.switch")),1)]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1},512),[[ne,e(u)==0]]),ie(t(ve,{key:"1"},{default:a(()=>[r("div",za,[t(be,{headers:[{title:e(l)("core.header.updateDialog.table.sha"),key:"sha"},{title:e(l)("core.header.updateDialog.table.date"),key:"date"},{title:e(l)("core.header.updateDialog.table.message"),key:"message"},{title:e(l)("core.header.updateDialog.table.actions"),key:"switch"}],items:e(j),"item-key":"sha"},{"item.switch":a(({item:n})=>[t(g,{onClick:I=>ee(n.sha),rounded:"xl",variant:"plain",color:"primary"},{default:a(()=>[d(s(e(l)("core.header.updateDialog.table.switch")),1)]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])])]),_:1},512),[[ne,e(u)==1]])]),_:1},8,["modelValue"]),r("h3",Ma,s(e(l)("core.header.updateDialog.manualInput.title")),1),t(Q,{label:e(l)("core.header.updateDialog.manualInput.placeholder"),modelValue:e($),"onUpdate:modelValue":o[8]||(o[8]=n=>L($)?$.value=n:$=n),required:"",variant:"outlined"},null,8,["label","modelValue"]),r("div",Ea,[r("small",null,s(e(l)("core.header.updateDialog.manualInput.hint")),1),Ra,r("a",Ua,[r("small",null,s(e(l)("core.header.updateDialog.manualInput.linkText")),1)])]),t(g,{color:"error",style:{"border-radius":"10px"},onClick:o[9]||(o[9]=n=>ee(e($)))},{default:a(()=>[d(s(e(l)("core.header.updateDialog.manualInput.confirm")),1)]),_:1}),t(ye,{class:"mt-4 mb-4"}),r("div",$a,[r("h3",Aa,s(e(l)("core.header.updateDialog.dashboardUpdate.title")),1),r("div",Ba,[r("small",null,s(e(l)("core.header.updateDialog.dashboardUpdate.currentVersion"))+" "+s(e(q)),1),Ha]),r("div",Pa,[e(U)?(c(),M("p",Na,s(e(l)("core.header.updateDialog.dashboardUpdate.hasNewVersion")),1)):(c(),M("p",Wa,s(e(l)("core.header.updateDialog.dashboardUpdate.isLatest")),1))]),t(g,{color:"primary",style:{"border-radius":"10px"},onClick:o[10]||(o[10]=n=>ze()),disabled:!e(U),loading:e(N)},{default:a(()=>[d(s(e(l)("core.header.updateDialog.dashboardUpdate.downloadAndUpdate")),1)]),_:1},8,["disabled","loading"])])]),_:1})]),_:1}),t(_e,null,{default:a(()=>[t(oe),t(g,{color:"blue-darken-1",variant:"text",onClick:o[11]||(o[11]=n=>L(T)?T.value=!1:T=!1)},{default:a(()=>[d(s(e(l)("core.common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width","fullscreen"]),t(we,{modelValue:e(v),"onUpdate:modelValue":o[20]||(o[20]=n=>L(v)?v.value=n:v=n),persistent:"","max-width":i.$vuetify.display.xs?"90%":"500"},{activator:a(({props:n})=>[t(g,le({size:"small",class:"action-btn mr-4",color:"var(--v-theme-surface)",variant:"flat",rounded:"sm"},n,{icon:""}),{default:a(()=>[t(x,null,{default:a(()=>[d("mdi-account")]),_:1})]),_:2},1040)]),default:a(()=>[t(he,{class:"account-dialog"},{default:a(()=>[t(ge,{class:"py-6"},{default:a(()=>[r("div",Fa,[t(aa,{title:e(l)("core.header.logoTitle"),subtitle:e(l)("core.header.accountDialog.title")},null,8,["title","subtitle"])]),e(C)?(c(),b(J,{key:0,type:"warning",variant:"tonal",border:"start",class:"mb-4"},{default:a(()=>[r("strong",null,s(e(l)("core.header.accountDialog.securityWarning")),1)]),_:1})):V("",!0),_.value.success?(c(),b(J,{key:1,type:"success",variant:"tonal",border:"start",class:"mb-4"},{default:a(()=>[d(s(_.value.message),1)]),_:1})):V("",!0),_.value.error?(c(),b(J,{key:2,type:"error",variant:"tonal",border:"start",class:"mb-4"},{default:a(()=>[d(s(_.value.message),1)]),_:1})):V("",!0),t(Ge,{modelValue:w.value,"onUpdate:modelValue":o[18]||(o[18]=n=>w.value=n),onSubmit:E(de,["prevent"])},{default:a(()=>[t(Q,{modelValue:e(k),"onUpdate:modelValue":o[13]||(o[13]=n=>L(k)?k.value=n:k=n),"append-inner-icon":K.value?"mdi-eye-off":"mdi-eye",type:K.value?"text":"password",label:e(l)("core.header.accountDialog.form.currentPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":o[14]||(o[14]=n=>K.value=!K.value),"prepend-inner-icon":"mdi-lock-outline","hide-details":"auto",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","label"]),t(Q,{modelValue:e(D),"onUpdate:modelValue":o[15]||(o[15]=n=>L(D)?D.value=n:D=n),"append-inner-icon":O.value?"mdi-eye-off":"mdi-eye",type:O.value?"text":"password",rules:R.value,label:e(l)("core.header.accountDialog.form.newPassword"),variant:"outlined",required:"",clearable:"","onClick:appendInner":o[16]||(o[16]=n=>O.value=!O.value),"prepend-inner-icon":"mdi-lock-plus-outline",hint:e(l)("core.header.accountDialog.form.passwordHint"),"persistent-hint":"",class:"mb-4"},null,8,["modelValue","append-inner-icon","type","rules","label","hint"]),t(Q,{modelValue:e(z),"onUpdate:modelValue":o[17]||(o[17]=n=>L(z)?z.value=n:z=n),rules:Z.value,label:e(l)("core.header.accountDialog.form.newUsername"),variant:"outlined",clearable:"","prepend-inner-icon":"mdi-account-edit-outline",hint:e(l)("core.header.accountDialog.form.usernameHint"),"persistent-hint":"",class:"mb-3"},null,8,["modelValue","rules","label","hint"])]),_:1},8,["modelValue","onSubmit"]),r("div",Xa,s(e(l)("core.header.accountDialog.form.defaultCredentials")),1)]),_:1}),t(ye),t(_e,{class:"pa-4"},{default:a(()=>[t(oe),e(C)?V("",!0):(c(),b(g,{key:0,variant:"tonal",color:"secondary",onClick:o[19]||(o[19]=n=>L(v)?v.value=!1:v=!1),disabled:_.value.loading},{default:a(()=>[d(s(e(l)("core.header.accountDialog.actions.cancel")),1)]),_:1},8,["disabled"])),t(g,{color:"primary",onClick:de,loading:_.value.loading,disabled:!w.value,"prepend-icon":"mdi-content-save"},{default:a(()=>[d(s(e(l)("core.header.accountDialog.actions.save")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"])]),_:1}))}});const qa={style:{height:"100%"}},ot=Ve({__name:"FullLayout",setup(h){const S=B(),f=p(null),l=async()=>{try{const v=await A.get("/api/stat/version");if(v.data.status==="ok"&&v.data.data.need_migration&&f.value&&typeof f.value.open=="function"){const C=await f.value.open();C.success&&(console.log("Migration completed successfully:",C.message),window.location.reload())}}catch(v){console.error("Failed to check migration status:",v)}};return Oe(()=>{setTimeout(l,1e3)}),(v,C)=>(c(),b(ea,null,{default:a(()=>[t(Ze,{theme:e(B)().uiTheme,class:Se([e(S).fontTheme,e(S).mini_sidebar?"mini-sidebar":"",e(S).inputBg?"inputWithbg":""])},{default:a(()=>[t(Ya),t(ha),t(Je,null,{default:a(()=>[t(Ce,{fluid:"",class:"page-wrapper",style:{height:"calc(100% - 8px)"}},{default:a(()=>[r("div",qa,[t(e(Qe))])]),_:1})]),_:1}),t(ia,{ref_key:"migrationDialog",ref:f},null,512)]),_:1},8,["theme","class"])]),_:1}))}});export{ot as default};
