import{u as W,a5 as Q,_ as P,k as y,b as o,w as i,I as A,o as h,D as E,E as U,l as c,t as d,V as q,d as u,aa as N,T as F,a7 as f,p as v,U as K,H as C,aP as R,at as T,S as O,aQ as j,aR as H,f as V,e as S,c as x,ab as k,X as M,B as D,m as J,F as X,n as G,j as Y,g as Z,i as $,a8 as ee,aJ as se,Q as te,W as ae,ag as le,aw as ie,ax as oe}from"./index-427e6df5.js";import{l as ne}from"./lodash-a7005334.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";const de={name:"SessionManagementPage",setup(){const{t:a}=W(),{tm:t}=Q("features/session-management");return{t:a,tm:t}},data(){return{loading:!1,sessions:[],searchQuery:"",filterPlatform:null,currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0,availablePersonas:[],availableChatProviders:[],availableSttProviders:[],availableTtsProviders:[],batchPersona:null,batchChatProvider:null,batchSttProvider:null,batchTtsProvider:null,batchLlmStatus:null,batchTtsStatus:null,batchUpdating:!1,pluginDialog:!1,selectedSessionForPlugin:null,sessionPlugins:[],loadingPlugins:!1,nameEditDialog:!1,selectedSessionForName:null,newSessionName:"",nameEditLoading:!1,snackbar:!1,snackbarText:"",snackbarColor:"success"}},computed:{messages(){return{updateSuccess:this.tm("messages.updateSuccess"),addSuccess:this.tm("messages.addSuccess"),deleteSuccess:this.tm("messages.deleteSuccess"),statusUpdateSuccess:this.tm("messages.statusUpdateSuccess"),deleteConfirm:this.tm("messages.deleteConfirm")}},subtitle(){return this.tm("subtitle")||"管理所有活跃的会话，配置人格、LLM提供商和插件"},headers(){return[{title:this.tm("table.headers.sessionStatus"),key:"session_enabled",sortable:!1,minWidth:"120px"},{title:this.tm("table.headers.sessionInfo"),key:"session_info",sortable:!1},{title:this.tm("table.headers.persona"),key:"persona",sortable:!1,minWidth:"150px"},{title:this.tm("table.headers.chatProvider"),key:"chat_provider",sortable:!1,minWidth:"200px"},{title:this.tm("table.headers.sttProvider"),key:"stt_provider",sortable:!1,minWidth:"200px"},{title:this.tm("table.headers.ttsProvider"),key:"tts_provider",sortable:!1,minWidth:"200px"},{title:this.tm("table.headers.llmStatus"),key:"llm_enabled",sortable:!1,minWidth:"120px"},{title:this.tm("table.headers.ttsStatus"),key:"tts_enabled",sortable:!1,minWidth:"120px"},{title:this.tm("table.headers.pluginManagement"),key:"plugins",sortable:!1,minWidth:"120px"},{title:this.tm("table.headers.actions"),key:"actions",sortable:!1,minWidth:"100px"}]},platformOptions(){return[...new Set(this.sessions.map(t=>t.platform))].map(t=>({title:t,value:t}))},personaOptions(){return[{label:this.tm("persona.none"),value:"[%None]"},...this.availablePersonas.map(t=>({label:t.name,value:t.name}))]},chatProviderOptions(){return this.availableChatProviders.map(a=>({label:`${a.name} (${a.model})`,value:a.id}))},sttProviderOptions(){return this.availableSttProviders.map(a=>({label:`${a.name} (${a.model})`,value:a.id}))},ttsProviderOptions(){return this.availableTtsProviders.map(a=>({label:`${a.name} (${a.model})`,value:a.id}))}},mounted(){this.loadSessions()},methods:{async loadSessions(){var a,t;this.loading=!0;try{const r={page:this.currentPage,page_size:this.itemsPerPage};this.searchQuery&&(r.search=this.searchQuery),this.filterPlatform&&(r.platform=this.filterPlatform);const l=await P.get("/api/session/list",{params:r});if(l.data.status==="ok"){const s=l.data.data;this.sessions=s.sessions.map(n=>({...n,updating:!1,loadingPlugins:!1,deleting:!1})),this.availablePersonas=s.available_personas,this.availableChatProviders=s.available_chat_providers,this.availableSttProviders=s.available_stt_providers,this.availableTtsProviders=s.available_tts_providers,s.pagination&&(this.totalItems=s.pagination.total,this.totalPages=s.pagination.total_pages,this.currentPage=s.pagination.page)}else this.showError(l.data.message||this.tm("messages.loadSessionsError"))}catch(r){this.showError(((t=(a=r.response)==null?void 0:a.data)==null?void 0:t.message)||this.tm("messages.loadSessionsError"))}this.loading=!1},async refreshSessions(){await this.loadSessions(),this.showSuccess(this.tm("messages.refreshSuccess"))},async updatePersona(a,t){return this._updateSession("persona",a,{persona_name:t},(r,l)=>{var s;l&&(r.persona_id=t,r.persona_name=t==="[%None]"?this.tm("persona.none"):((s=this.availablePersonas.find(n=>n.name===t))==null?void 0:s.name)||t)})},async updateProvider(a,t,r){return this._updateSession("provider",a,{provider_id:t,provider_type:r},(l,s)=>{if(s){if(r==="chat_completion"){l.chat_provider_id=t;const n=this.availableChatProviders.find(e=>e.id===t);l.chat_provider_name=(n==null?void 0:n.name)||t}else if(r==="speech_to_text"){l.stt_provider_id=t;const n=this.availableSttProviders.find(e=>e.id===t);l.stt_provider_name=(n==null?void 0:n.name)||t}else if(r==="text_to_speech"){l.tts_provider_id=t;const n=this.availableTtsProviders.find(e=>e.id===t);l.tts_provider_name=(n==null?void 0:n.name)||t}}})},async updateLLM(a,t){return this._updateSession("llm",a,{enabled:t},(r,l)=>{l&&(r.llm_enabled=t)})},async updateTTS(a,t){return this._updateSession("tts",a,{enabled:t},(r,l)=>{l&&(r.tts_enabled=t)})},async _updateSession(a,t,r,l){var n,e,m,b;if(Array.isArray(t)){const p=t,_=p.map(g=>g.session_id);try{const g={is_batch:!0,session_ids:_,...r},L=await P.post(`/api/session/update_${a}`,g);if(L.data.status==="ok"){const w=L.data.data;return p.forEach(z=>{const B=!w.error_sessions||!w.error_sessions.includes(z.session_id);l(z,B)}),{success:!0,successCount:w.success_count||0,errorCount:w.error_count||0,errorSessions:w.error_sessions||[]}}else return{success:!1,error:L.data.message,errorCount:_.length,successCount:0}}catch(g){return{success:!1,error:((b=(m=g.response)==null?void 0:m.data)==null?void 0:b.message)||g.message,errorCount:_.length,successCount:0}}}else{const p=t;p.updating=!0;try{const _={is_batch:!1,session_id:p.session_id,...r},g=await P.post(`/api/session/update_${a}`,_);return g.data.status==="ok"?(l(p,!0),this.showSuccess(this.tm(`messages.${a}UpdateSuccess`)),{success:!0}):(this.showError(g.data.message||this.tm(`messages.${a}UpdateError`)),{success:!1,error:g.data.message})}catch(_){return this.showError(((e=(n=_.response)==null?void 0:n.data)==null?void 0:e.message)||this.tm(`messages.${a}UpdateError`)),{success:!1,error:_.message}}finally{p.updating=!1}}},async updateSessionStatus(a,t){var r,l;a.updating=!0;try{const s=await P.post("/api/session/update_status",{session_id:a.session_id,session_enabled:t});s.data.status==="ok"?(a.session_enabled=t,this.showSuccess(this.tm("messages.sessionStatusSuccess",{status:t?this.tm("status.enabled"):this.tm("status.disabled")}))):this.showError(s.data.message||this.tm("messages.statusUpdateError"))}catch(s){this.showError(((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.message)||this.tm("messages.statusUpdateError"))}a.updating=!1},async applyBatchChanges(){if(!this.batchPersona&&!this.batchChatProvider&&!this.batchSttProvider&&!this.batchTtsProvider&&this.batchLlmStatus===null&&this.batchTtsStatus===null)return;this.batchUpdating=!0;let a=0,t=0,r=[];const l=this.sessions;try{const s=[];this.batchPersona&&s.push({type:"persona",params:{persona_name:this.batchPersona}}),this.batchChatProvider&&s.push({type:"provider",params:{provider_id:this.batchChatProvider,provider_type:"chat_completion"}}),this.batchSttProvider&&s.push({type:"provider",params:{provider_id:this.batchSttProvider,provider_type:"speech_to_text"}}),this.batchTtsProvider&&s.push({type:"provider",params:{provider_id:this.batchTtsProvider,provider_type:"text_to_speech"}}),this.batchLlmStatus!==null&&s.push({type:"llm",params:{enabled:this.batchLlmStatus}}),this.batchTtsStatus!==null&&s.push({type:"tts",params:{enabled:this.batchTtsStatus}});for(const n of s){let e;switch(n.type){case"persona":e=(b,p)=>{p&&(b.persona_id=n.params.persona_name)};break;case"provider":e=(b,p)=>{if(!p)return;const{provider_id:_,provider_type:g}=n.params;g==="chat_completion"?b.chat_provider_id=_:g==="speech_to_text"?b.stt_provider_id=_:g==="text_to_speech"&&(b.tts_provider_id=_)};break;case"llm":e=(b,p)=>{p&&(b.llm_enabled=n.params.enabled)};break;case"tts":e=(b,p)=>{p&&(b.tts_enabled=n.params.enabled)};break}const m=await this._updateSession(n.type,l,n.params,e);a+=m.successCount||0,t+=m.errorCount||0,m.errorSessions&&r.push(...m.errorSessions)}if(t===0)this.showSuccess(this.tm("messages.batchUpdateSuccess",{count:a}));else{const n=[...new Set(r)];this.showError(this.tm("messages.batchUpdatePartial",{success:a,error:n.length}))}}catch{this.showError(this.tm("messages.batchUpdateError"))}this.batchUpdating=!1,this.batchPersona=null,this.batchChatProvider=null,this.batchSttProvider=null,this.batchTtsProvider=null,this.batchLlmStatus=null,this.batchTtsStatus=null},async openPluginManager(a){var t,r;this.selectedSessionForPlugin=a,this.pluginDialog=!0,this.loadingPlugins=!0,this.sessionPlugins=[];try{const l=await P.get("/api/session/plugins",{params:{session_id:a.session_id}});l.data.status==="ok"?this.sessionPlugins=l.data.data.plugins.map(s=>({...s,updating:!1})):this.showError(l.data.message||this.tm("messages.loadPluginsError"))}catch(l){this.showError(((r=(t=l.response)==null?void 0:t.data)==null?void 0:r.message)||this.tm("messages.loadPluginsError"))}this.loadingPlugins=!1},async togglePlugin(a,t){var r,l;a.updating=!0;try{const s=await P.post("/api/session/update_plugin",{session_id:this.selectedSessionForPlugin.session_id,plugin_name:a.name,enabled:t});s.data.status==="ok"?(a.enabled=t,this.showSuccess(this.tm("messages.pluginStatusSuccess",{name:a.name,status:t?this.tm("status.enabled"):this.tm("status.disabled")}))):this.showError(s.data.message||this.tm("messages.pluginStatusError"))}catch(s){this.showError(((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.message)||this.tm("messages.pluginStatusError"))}a.updating=!1},openNameEditor(a){this.selectedSessionForName=a,this.newSessionName=a.session_name===a.session_raw_name?"":a.session_name,this.nameEditDialog=!0},async saveSessionName(){var a,t;if(this.selectedSessionForName){this.nameEditLoading=!0;try{const r=await P.post("/api/session/update_name",{session_id:this.selectedSessionForName.session_id,custom_name:this.newSessionName||""});r.data.status==="ok"?(this.selectedSessionForName.session_name=r.data.data.display_name,this.showSuccess(r.data.data.message||this.tm("messages.nameUpdateSuccess")),this.nameEditDialog=!1):this.showError(r.data.message||this.tm("messages.nameUpdateError"))}catch(r){this.showError(((t=(a=r.response)==null?void 0:a.data)==null?void 0:t.message)||this.tm("messages.nameUpdateError"))}this.nameEditLoading=!1}},getPlatformColor(a){const t={aiocqhttp:"blue",wechatpadpro:"green",qq_official:"purple",telegram:"light-blue",discord:"indigo",default:"grey"};return t[a]||t.default},showSuccess(a){this.snackbarText=a,this.snackbarColor="success",this.snackbar=!0},showError(a){this.snackbarText=a,this.snackbarColor="error",this.snackbar=!0},async deleteSession(a){var r,l;const t=this.tm("deleteConfirm.message",{sessionName:a.session_name||a.session_id})+`

`+this.tm("deleteConfirm.warning");if(confirm(t)){a.deleting=!0;try{const s=await P.post("/api/session/delete",{session_id:a.session_id});if(s.data.status==="ok"){this.showSuccess(s.data.data.message||this.tm("messages.deleteSuccess"));const n=this.sessions.findIndex(e=>e.session_id===a.session_id);n>-1&&this.sessions.splice(n,1)}else this.showError(s.data.message||this.tm("messages.deleteError"))}catch(s){this.showError(((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.message)||this.tm("messages.deleteError"))}a.deleting=!1}},handlePaginationUpdate(a){this.currentPage=a.page,this.itemsPerPage=a.itemsPerPage,this.loadSessions()},handleSearchChange:ne.debounce(function(){this.currentPage=1,this.loadSessions()},300),handlePlatformChange(){this.currentPage=1,this.loadSessions()}}},I=a=>(ie("data-v-7c1f9438"),a=a(),oe(),a),me={class:"session-management-page"},ce={class:"text-h4"},ue={class:"d-flex align-center"},he={key:0},pe={style:{color:"grey"}},ge={key:1},be=I(()=>c("p",null,"使用 /sid 指令可查看会话 ID。",-1)),_e=I(()=>c("p",null,"会话信息：",-1)),fe={key:0},ve={key:1},Pe={key:2},ye={style:{"font-size":"12px"}},Se={style:{"font-size":"12px"}},xe={style:{"font-size":"12px"}},Ve={style:{"font-size":"12px"}},ke={class:"text-center py-8"},we={class:"text-h6 mt-4 text-grey-600"},Ce={class:"text-body-2 text-grey-500"},Ee={class:"text-h4"},Ue={style:{padding:"16px"}},Te={class:"d-flex justify-end align-center mt-8"},Le={style:{"padding-left":"16px","padding-right":"16px"}},Ne={key:0,class:"text-center py-8"},Oe={class:"text-h6 mt-4 text-grey-600"},De={class:"text-body-2 text-grey-500"},ze={class:"text-body-1 mt-4"},Fe={style:{"padding-left":"16px","padding-right":"16px"}},Me={class:"text-caption text-grey-600 mb-2"},Ie={class:"text-caption text-grey-600 mb-2"};function Be(a,t,r,l,s,n){return h(),y("div",me,[o(A,{fluid:"",class:"pa-0"},{default:i(()=>[o(E,{flat:""},{default:i(()=>[o(U,{class:"d-flex align-center py-3 px-4"},{default:i(()=>[c("span",ce,d(l.tm("sessions.activeSessions")),1),o(q,{size:"small",class:"ml-2"},{default:i(()=>[u(d(s.totalItems)+" "+d(l.tm("sessions.sessionCount")),1)]),_:1}),o(N,{class:"me-4 ms-4",dense:""},{default:i(()=>[o(F,{modelValue:s.searchQuery,"onUpdate:modelValue":[t[0]||(t[0]=e=>s.searchQuery=e),n.handleSearchChange],"prepend-inner-icon":"mdi-magnify",label:l.tm("search.placeholder"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",class:"me-4",density:"compact"},null,8,["modelValue","label","onUpdate:modelValue"]),o(f,{modelValue:s.filterPlatform,"onUpdate:modelValue":[t[1]||(t[1]=e=>s.filterPlatform=e),n.handlePlatformChange],items:n.platformOptions,label:l.tm("search.platformFilter"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",class:"me-4",style:{"max-width":"150px"},density:"compact"},null,8,["modelValue","items","label","onUpdate:modelValue"])]),_:1}),o(v,{color:"primary","prepend-icon":"mdi-refresh",variant:"tonal",onClick:n.refreshSessions,loading:s.loading,size:"small"},{default:i(()=>[u(d(l.tm("buttons.refresh")),1)]),_:1},8,["onClick","loading"])]),_:1}),o(K),o(C,{class:"pa-0"},{default:i(()=>[o(R,{headers:n.headers,items:s.sessions,loading:s.loading,"items-per-page":s.itemsPerPage,page:s.currentPage,"items-length":s.totalItems,"onUpdate:options":n.handlePaginationUpdate,density:"compact",class:"elevation-0",style:{"font-size":"11px"}},{"item.session_enabled":i(({item:e})=>[o(T,{"model-value":e.session_enabled,"onUpdate:modelValue":m=>n.updateSessionStatus(e,m),loading:e.updating,"hide-details":"",density:"compact",color:"success"},null,8,["model-value","onUpdate:modelValue","loading"])]),"item.session_info":i(({item:e})=>[c("div",null,[c("div",ue,[o(O,{location:"top"},{activator:i(({props:m})=>[e.session_name!==e.session_raw_name?(h(),y("div",he,[c("span",null,d(e.session_name),1),c("span",pe,"("+d(e.session_id)+")",1)])):(h(),y("div",ge,[c("span",j(H(m)),d(e.session_id),17)]))]),default:i(()=>[c("div",null,[be,_e,c("ul",null,[c("li",null,"平台: "+d(e.platform),1),e.user_name?(h(),y("li",fe,"用户: "+d(e.user_name),1)):V("",!0),e.message_type?(h(),y("li",ve,"消息类型: "+d(e.message_type),1)):V("",!0),e.session_raw_name?(h(),y("li",Pe,"会话 ID: "+d(e.session_raw_name),1)):V("",!0)])])]),_:2},1024),o(v,{icon:"",size:"x-small",variant:"plain",onClick:m=>n.openNameEditor(e),class:"ml-2",loading:e.updating},{default:i(()=>[o(S,null,{default:i(()=>[u("mdi-pencil")]),_:1}),o(O,{activator:"parent",location:"top"},{default:i(()=>[u(d(l.tm("buttons.editName")),1)]),_:1})]),_:2},1032,["onClick","loading"])])])]),"item.persona":i(({item:e})=>[o(f,{"model-value":e.persona_id||"",items:n.personaOptions,"item-title":"label","item-value":"value","hide-details":"",density:"compact",variant:"solo-filled",flat:"","onUpdate:modelValue":m=>n.updatePersona(e,m),loading:e.updating,disabled:!e.session_enabled},{selection:i(({item:m})=>[c("span",ye,d(m.raw.label),1)]),_:2},1032,["model-value","items","onUpdate:modelValue","loading","disabled"])]),"item.chat_provider":i(({item:e})=>[o(f,{"model-value":e.chat_provider_id||"",items:n.chatProviderOptions,"item-title":"label","item-value":"value","hide-details":"",density:"compact",variant:"solo-filled",flat:"","onUpdate:modelValue":m=>n.updateProvider(e,m,"chat_completion"),loading:e.updating,disabled:!e.session_enabled},{selection:i(({item:m})=>[c("span",Se,d(m.raw.label),1)]),_:2},1032,["model-value","items","onUpdate:modelValue","loading","disabled"])]),"item.stt_provider":i(({item:e})=>[o(f,{"model-value":e.stt_provider_id||"",items:n.sttProviderOptions,"item-title":"label","item-value":"value","hide-details":"",density:"compact",variant:"solo-filled",flat:"","onUpdate:modelValue":m=>n.updateProvider(e,m,"speech_to_text"),loading:e.updating,disabled:n.sttProviderOptions.length===0||!e.session_enabled},{selection:i(({item:m})=>[c("span",xe,d(m.raw.label),1)]),_:2},1032,["model-value","items","onUpdate:modelValue","loading","disabled"])]),"item.tts_provider":i(({item:e})=>[o(f,{"model-value":e.tts_provider_id||"",items:n.ttsProviderOptions,"item-title":"label","item-value":"value","hide-details":"",density:"compact",variant:"solo-filled",flat:"","onUpdate:modelValue":m=>n.updateProvider(e,m,"text_to_speech"),loading:e.updating,disabled:n.ttsProviderOptions.length===0||!e.session_enabled},{selection:i(({item:m})=>[c("span",Ve,d(m.raw.label),1)]),_:2},1032,["model-value","items","onUpdate:modelValue","loading","disabled"])]),"item.llm_enabled":i(({item:e})=>[o(T,{"model-value":e.llm_enabled,"onUpdate:modelValue":m=>n.updateLLM(e,m),loading:e.updating,disabled:!e.session_enabled,"hide-details":"",density:"compact",color:"primary"},null,8,["model-value","onUpdate:modelValue","loading","disabled"])]),"item.tts_enabled":i(({item:e})=>[o(T,{"model-value":e.tts_enabled,"onUpdate:modelValue":m=>n.updateTTS(e,m),loading:e.updating,disabled:!e.session_enabled,"hide-details":"",density:"compact",color:"secondary"},null,8,["model-value","onUpdate:modelValue","loading","disabled"])]),"item.plugins":i(({item:e})=>[o(v,{size:"x-small",variant:"tonal",color:"primary",onClick:m=>n.openPluginManager(e),loading:e.loadingPlugins,disabled:!e.session_enabled},{default:i(()=>[u(d(l.tm("buttons.edit")),1)]),_:2},1032,["onClick","loading","disabled"])]),"item.actions":i(({item:e})=>[o(v,{size:"x-small",variant:"tonal",color:"error",onClick:m=>n.deleteSession(e),loading:e.deleting,icon:""},{default:i(()=>[o(S,null,{default:i(()=>[u("mdi-delete")]),_:1}),o(O,{activator:"parent",location:"top"},{default:i(()=>[u(d(l.tm("buttons.delete")),1)]),_:1})]),_:2},1032,["onClick","loading"])]),"no-data":i(()=>[c("div",ke,[o(S,{size:"64",color:"grey-400"},{default:i(()=>[u("mdi-account-group-outline")]),_:1}),c("div",we,d(l.tm("sessions.noActiveSessions")),1),c("div",Ce,d(l.tm("sessions.noActiveSessionsDesc")),1)])]),_:1},8,["headers","items","loading","items-per-page","page","items-length","onUpdate:options"])]),_:1})]),_:1}),o(E,{flat:"",class:"mt-4"},{default:i(()=>[o(U,{class:"d-flex align-center py-3 px-4"},{default:i(()=>[c("span",Ee,d(l.tm("batchOperations.title")),1)]),_:1}),o(C,null,{default:i(()=>[c("div",Ue,[o(N,null,{default:i(()=>[s.availablePersonas.length>0?(h(),x(k,{key:0,cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchPersona,"onUpdate:modelValue":t[2]||(t[2]=e=>s.batchPersona=e),items:n.personaOptions,"item-title":"label","item-value":"value",label:l.tm("batchOperations.setPersona"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select"},null,8,["modelValue","items","label"])]),_:1})):V("",!0),s.availableChatProviders.length>0?(h(),x(k,{key:1,cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchChatProvider,"onUpdate:modelValue":t[3]||(t[3]=e=>s.batchChatProvider=e),items:n.chatProviderOptions,"item-title":"label","item-value":"value",label:l.tm("batchOperations.setChatProvider"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select"},null,8,["modelValue","items","label"])]),_:1})):V("",!0),o(k,{cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchSttProvider,"onUpdate:modelValue":t[4]||(t[4]=e=>s.batchSttProvider=e),items:n.sttProviderOptions,"item-title":"label","item-value":"value",label:l.tm("batchOperations.setSttProvider"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select",disabled:s.availableSttProviders.length===0,placeholder:s.availableSttProviders.length===0?l.tm("batchOperations.noSttProvider"):""},null,8,["modelValue","items","label","disabled","placeholder"])]),_:1}),o(k,{cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchTtsProvider,"onUpdate:modelValue":t[5]||(t[5]=e=>s.batchTtsProvider=e),items:n.ttsProviderOptions,"item-title":"label","item-value":"value",label:l.tm("batchOperations.setTtsProvider"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select",disabled:s.availableTtsProviders.length===0,placeholder:s.availableTtsProviders.length===0?l.tm("batchOperations.noTtsProvider"):""},null,8,["modelValue","items","label","disabled","placeholder"])]),_:1})]),_:1}),o(N,null,{default:i(()=>[o(k,{cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchLlmStatus,"onUpdate:modelValue":t[6]||(t[6]=e=>s.batchLlmStatus=e),items:[{label:l.tm("status.enabled"),value:!0},{label:l.tm("status.disabled"),value:!1}],"item-title":"label","item-value":"value",label:l.tm("batchOperations.setLlmStatus"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select"},null,8,["modelValue","items","label"])]),_:1}),o(k,{cols:"12",md:"6",lg:"3"},{default:i(()=>[o(f,{modelValue:s.batchTtsStatus,"onUpdate:modelValue":t[7]||(t[7]=e=>s.batchTtsStatus=e),items:[{label:l.tm("status.enabled"),value:!0},{label:l.tm("status.disabled"),value:!1}],"item-title":"label","item-value":"value",label:l.tm("batchOperations.setTtsStatus"),"hide-details":"",clearable:"",variant:"solo-filled",flat:"",density:"comfortable",class:"batch-select"},null,8,["modelValue","items","label"])]),_:1})]),_:1}),c("div",Te,[o(v,{color:"primary",variant:"tonal",size:"large",rounded:"lg",onClick:n.applyBatchChanges,disabled:!s.batchPersona&&!s.batchChatProvider&&!s.batchSttProvider&&!s.batchTtsProvider&&s.batchLlmStatus===null&&s.batchTtsStatus===null,loading:s.batchUpdating,class:"me-3"},{default:i(()=>[o(S,{start:""},{default:i(()=>[u("mdi-check-all")]),_:1}),u(" "+d(l.tm("buttons.apply")),1)]),_:1},8,["onClick","disabled","loading"])])])]),_:1})]),_:1}),o(M,{modelValue:s.pluginDialog,"onUpdate:modelValue":t[9]||(t[9]=e=>s.pluginDialog=e),"max-width":"800","min-height":"80%"},{default:i(()=>[s.selectedSessionForPlugin?(h(),x(E,{key:0},{default:i(()=>[o(U,{class:"bg-primary text-white py-3 px-4",style:{display:"flex","align-items":"center"}},{default:i(()=>[c("span",null,d(l.tm("pluginManagement.title"))+" - "+d(s.selectedSessionForPlugin.session_name),1),o(D),o(v,{icon:"",variant:"text",color:"white",onClick:t[8]||(t[8]=e=>s.pluginDialog=!1)},{default:i(()=>[o(S,null,{default:i(()=>[u("mdi-close")]),_:1})]),_:1})]),_:1}),s.loadingPlugins?(h(),x(C,{key:1,class:"text-center py-8"},{default:i(()=>[o(ee,{indeterminate:"",color:"primary",size:"48"}),c("div",ze,d(l.tm("pluginManagement.loading")),1)]),_:1})):(h(),x(C,{key:0},{default:i(()=>[c("div",Le,[s.sessionPlugins.length===0?(h(),y("div",Ne,[o(S,{size:"64",color:"grey-400"},{default:i(()=>[u("mdi-puzzle-outline")]),_:1}),c("div",Oe,d(l.tm("pluginManagement.noPlugins")),1),c("div",De,d(l.tm("pluginManagement.noPluginsDesc")),1)])):(h(),x(J,{key:1},{default:i(()=>[(h(!0),y(X,null,G(s.sessionPlugins,e=>(h(),x(Y,{key:e.name,class:"px-0"},{prepend:i(()=>[o(S,{color:e.enabled?"success":"grey"},{default:i(()=>[u(d(e.enabled?"mdi-check-circle":"mdi-circle-outline"),1)]),_:2},1032,["color"])]),append:i(()=>[o(T,{"model-value":e.enabled,"hide-details":"",color:"primary","onUpdate:modelValue":m=>n.togglePlugin(e,m),loading:e.updating},null,8,["model-value","onUpdate:modelValue","loading"])]),default:i(()=>[o(Z,{class:"font-weight-medium"},{default:i(()=>[u(d(e.name),1)]),_:2},1024),o($,null,{default:i(()=>[u(d(l.tm("pluginManagement.author"))+": "+d(e.author),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}))])]),_:1}))]),_:1})):V("",!0)]),_:1},8,["modelValue"]),o(M,{modelValue:s.nameEditDialog,"onUpdate:modelValue":t[13]||(t[13]=e=>s.nameEditDialog=e),"max-width":"500","min-height":"60%"},{default:i(()=>[s.selectedSessionForName?(h(),x(E,{key:0},{default:i(()=>[o(U,{class:"bg-primary text-white py-3 px-4",style:{display:"flex","align-items":"center"}},{default:i(()=>[c("span",null,d(l.tm("nameEditor.title")),1),o(D),o(v,{icon:"",variant:"text",color:"white",onClick:t[10]||(t[10]=e=>s.nameEditDialog=!1)},{default:i(()=>[o(S,null,{default:i(()=>[u("mdi-close")]),_:1})]),_:1})]),_:1}),o(C,null,{default:i(()=>[c("div",Fe,[o(F,{modelValue:s.newSessionName,"onUpdate:modelValue":t[11]||(t[11]=e=>s.newSessionName=e),label:l.tm("nameEditor.customName"),placeholder:l.tm("nameEditor.placeholder"),variant:"solo-filled",flat:"","hide-details":"auto",clearable:"",class:"mb-4",onKeyup:se(n.saveSessionName,["enter"])},null,8,["modelValue","label","placeholder","onKeyup"]),c("div",Me,d(l.tm("nameEditor.originalName"))+": "+d(s.selectedSessionForName.session_raw_name),1),c("div",Ie,d(l.tm("nameEditor.fullSessionId"))+": "+d(s.selectedSessionForName.session_id),1),o(te,{variant:"tonal",type:"info",density:"compact",class:"mb-4"},{default:i(()=>[u(d(l.tm("nameEditor.hint")),1)]),_:1})])]),_:1}),o(ae,{class:"px-4 pb-4"},{default:i(()=>[o(D),o(v,{color:"grey",variant:"text",onClick:t[12]||(t[12]=e=>s.nameEditDialog=!1),disabled:s.nameEditLoading},{default:i(()=>[u(d(l.tm("buttons.cancel")),1)]),_:1},8,["disabled"]),o(v,{color:"primary",variant:"tonal",onClick:n.saveSessionName,loading:s.nameEditLoading},{default:i(()=>[u(d(l.tm("buttons.save")),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"]),o(le,{modelValue:s.snackbar,"onUpdate:modelValue":t[14]||(t[14]=e=>s.snackbar=e),timeout:3e3,elevation:"24",color:s.snackbarColor,location:"top"},{default:i(()=>[u(d(s.snackbarText),1)]),_:1},8,["modelValue","color"])]),_:1})])}const qe=re(de,[["render",Be],["__scopeId","data-v-7c1f9438"]]);export{qe as default};
